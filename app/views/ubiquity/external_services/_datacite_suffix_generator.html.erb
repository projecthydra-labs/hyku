
 <%= button_to "Create and save draft DOI", main_app.external_services_generate_doi_path, data: {'tenant-name' => current_account.cname },
 id: "ubiquity-datacite-draft_doi", class: "btn btn-primary" %>
 <span id="draft_doi"></span>

<script>

 $(document).on("turbolinks:load", function(event){
   return $("body").on("click", "#ubiquity-datacite-draft_doi", function(event) {
     $("#ubiquity-datacite-draft_doi").hide()
     event.preventDefault();
     var tenantName = $(this).attr('data-tenant-name');
     $.ajax({
       url: '/external_services/generate_doi',
       type: "POST",
       data: {tenant_name: tenantName},
       success: function(result){
       $("#draft_doi").html(result.draft_doi);
       $(".ubiquity-draft-doi").val(result.draft_doi);
         if (result.draft_doi== 'taken'){

         } else {

         }
       },
       error: function(){
       }
     })

   });
 });

</script>
